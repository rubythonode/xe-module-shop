<include target="_tool_header.html" />
<load target="css/form.css" />

<script type="text/javascript">
    jQuery(document).ready(function($){
	    var showUrl = function() {
			hideAll();
			$("#text_url_container").show();
		};

        var showSitesList = function() {
            hideAll();
            $("#site_srl_container").show();
        }

	    var showMidListAndLoadData = function($module_type, $site_srl) {
			hideAll();
            $("#site_srl_container").show();

			$.exec_json('shop.procShopServiceGetModulesByTypeAndSiteSrl'
				, { module_type : $module_type, site_srl : $site_srl}
				, function(data) {
					if(data.error != 0)
					{
						alert("Error " + data.error + " " + data.message);
						return;
					}
				    $mid_list = data.mid_list;

					// Remove previous entries
					$("#mid_url_container select").html("<option value=''></option>");
				    // Add new mids
				    for(var $mid in $mid_list)
					{
						$("#mid_url_container select").append("<option value=" + $mid + ">" + $mid + "</option>");
					}
					$("#mid_url_container").show();
				}
			);
		};
	    var hideAll = function() {
			$("#mid_url_container").hide();
			$("#text_url_container").hide();
            $("#site_srl_container").hide();
		}

   	    $("#module_type").change(function(){
		    $module_type = $(this).val();

			if(!$module_type)
			{
			    hideAll();
			}
		    else if($module_type == 'url')
			{
			    showUrl();
			}
			else
			{
                showSitesList();
			}
		});

        $("#site_srl").change(function(){
            $("#domain").val($(this).find(":selected").text());

            $site_srl = $(this).val();
            if($site_srl === "")
            {
                return;
            }

            $module_type = $("#module_type").val();

            showMidListAndLoadData($module_type, $site_srl);
        });
	});
</script>

<!-- Content -->
<div id="content">

	<!-- contentHeader -->
	<div class="contentHeader setupHeader lineBottom">
		<h3 class="h3">{$lang->shop_second_menus[4]['dispShopToolExtraMenuModuleInsert']}</h3>
	</div>
	<!-- /contentHeader -->

	<div class="listHeader">
		<p class="info">{$lang->about_shop_extra_menu}</p>
	</div>

	<form action="./">
	    <input type="hidden" name="vid" value="{$vid}" />
		<input type="hidden" name="act" value="procShopToolInsertMenuItem" />
	    <p>
		    <label for="module_type">Type</label>
			<select id="module_type" name="module_type">
				<option value="">{$lang->cmd_select}</option>
				<!--@foreach($service_modules as $module)-->
				<option value="{$module->module}" title="{$module->description}">{$module->title}</option>
				<!--@end-->
				<option value="url" <!--@if($item_info->module_type == 'url')-->selected="selected"<!--@end-->>{$lang->url}</option>
			</select>

	    </p>

	    <p id="text_url_container" style="display: none">
			<label for="text_url">URL</label>
			<input type="text" id="text_url" name="text_url" />
	    </p>

        <p id="site_srl_container" style="display: none">
            <label for="site_srl">Site</label>
            <select id="site_srl" name="site_srl">
                <option value="" />
                <!--@foreach($site_list as $site)-->
                <option value="{$site->site_srl}">{$site->domain}</option>
                <!--@end-->
            </select>
            <input type="hidden" name="domain" id="domain" />
        </p>

        <p id="mid_url_container" style="display: none">
            <label for="mid_url">Module</label>
			<select id="mid_url" name="mid_url">
			</select>
		</p>

	    <p>
		    <label for="menu_name">Menu name</label>
		    <input type="text" id="menu_name" name="menu_name" value="" />
	    </p>

		<p class="submit">
			<span class="btnGray medium">
				<input type="submit" value="Submit" class="submit">
			</span>
		</p>


	</form>


</div>

<!-- /Content -->

<!-- Extension -->
<include target="_tool_menu.html" />
<!-- Extension -->
